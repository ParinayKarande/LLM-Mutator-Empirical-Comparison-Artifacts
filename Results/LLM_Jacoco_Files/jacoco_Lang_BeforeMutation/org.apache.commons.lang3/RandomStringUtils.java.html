<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>RandomStringUtils.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Apache Commons Lang</a> &gt; <a href="index.source.html" class="el_package">org.apache.commons.lang3</a> &gt; <span class="el_source">RandomStringUtils.java</span></div><h1>RandomStringUtils.java</h1><pre class="source lang-java linenums">/*
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the &quot;License&quot;); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.apache.commons.lang3;

import java.security.SecureRandom;
import java.security.Security;
import java.util.Random;
import java.util.concurrent.ThreadLocalRandom;
import java.util.function.Supplier;

/**
 * Generates random {@link String}s.
 * &lt;p&gt;
 * Starting in version 3.16.0, this class uses {@link #secure()} for static methods and adds {@link #insecure()}.
 * &lt;/p&gt;
 * &lt;p&gt;
 * Starting in version 3.15.0, this class uses {@link SecureRandom#getInstanceStrong()} for static methods.
 * &lt;/p&gt;
 * &lt;p&gt;
 * Before version 3.15.0, this class used {@link ThreadLocalRandom#current()} for static methods, which is not
 * cryptographically secure.
 * &lt;/p&gt;
 * &lt;p&gt;
 * Use {@link #secure()} to get the singleton instance based on {@link SecureRandom#getInstanceStrong()} which uses an
 * algorithms/providers specified in the {@code securerandom.strongAlgorithms} {@link Security} property.
 * &lt;/p&gt;
 * &lt;p&gt;
 * Use {@link #insecure()} to get the singleton instance based on {@link ThreadLocalRandom#current()}; &lt;b&gt;which is not
 * cryptographically secure&lt;/b&gt;.
 * &lt;/p&gt;
 * &lt;p&gt;
 * RandomStringUtils is intended for simple use cases. For more advanced use cases consider using Apache Commons Text's
 * &lt;a href=
 * &quot;https://commons.apache.org/proper/commons-text/javadocs/api-release/org/apache/commons/text/RandomStringGenerator.html&quot;&gt;
 * RandomStringGenerator&lt;/a&gt; instead.
 * &lt;/p&gt;
 * &lt;p&gt;
 * The Apache Commons project provides &lt;a href=&quot;https://commons.apache.org/proper/commons-rng/&quot;&gt;Commons RNG&lt;/a&gt;
 * dedicated to pseudo-random number generation, that may be a better choice for applications with more stringent
 * requirements (performance and/or correctness).
 * &lt;/p&gt;
 * &lt;p&gt;
 * Note that &lt;em&gt;private high surrogate&lt;/em&gt; characters are ignored. These are Unicode characters that fall between the
 * values 56192 (db80) and 56319 (dbff) as we don't know how to handle them. High and low surrogates are correctly dealt
 * with - that is if a high surrogate is randomly chosen, 55296 (d800) to 56191 (db7f) then it is followed by a low
 * surrogate. If a low surrogate is chosen, 56320 (dc00) to 57343 (dfff) then it is placed after a randomly chosen high
 * surrogate.
 * &lt;/p&gt;
 * &lt;p&gt;
 * #ThreadSafe#
 * &lt;/p&gt;
 *
 * @see RandomUtils
 * @since 1.0
 */
public class RandomStringUtils {

<span class="fc" id="L72">    private static final Supplier&lt;RandomUtils&gt; SECURE_SUPPLIER = RandomUtils::secure;</span>

<span class="fc" id="L74">    private static RandomStringUtils INSECURE = new RandomStringUtils(RandomUtils::insecure);</span>

<span class="fc" id="L76">    private static RandomStringUtils SECURE = new RandomStringUtils(SECURE_SUPPLIER);</span>

<span class="fc" id="L78">    private static final char[] ALPHANUMERICAL_CHARS = { 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l',</span>
            'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', 'A', 'B', 'C', 'D', 'E', 'F', 'G',
            'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', '0', '1',
            '2', '3', '4', '5', '6', '7', '8', '9' };

    /**
     * Gets the singleton instance based on {@link ThreadLocalRandom#current()}; &lt;b&gt;which is not cryptographically
     * secure&lt;/b&gt;; use {@link #secure()} to use an algorithms/providers specified in the
     * {@code securerandom.strongAlgorithms} {@link Security} property.
     * &lt;p&gt;
     * The method {@link ThreadLocalRandom#current()} is called on-demand.
     * &lt;/p&gt;
     *
     * @return the singleton instance based on {@link ThreadLocalRandom#current()}.
     * @see ThreadLocalRandom#current()
     * @see #secure()
     * @since 3.16.0
     */
    public static RandomStringUtils insecure() {
<span class="fc" id="L97">        return INSECURE;</span>
    }

    /**
     * Creates a random string whose length is the number of characters specified.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of all characters.
     * &lt;/p&gt;
     *
     * @param count the length of random string to create
     * @return the random string
     * @throws IllegalArgumentException if {@code count} &amp;lt; 0.
     */
    public static String random(final int count) {
<span class="fc" id="L112">        return secure().next(count);</span>
    }

    /**
     * Creates a random string whose length is the number of characters specified.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of alpha-numeric characters as indicated by the arguments.
     * &lt;/p&gt;
     *
     * @param count   the length of random string to create
     * @param letters if {@code true}, generated string may include alphabetic characters
     * @param numbers if {@code true}, generated string may include numeric characters
     * @return the random string
     * @throws IllegalArgumentException if {@code count} &amp;lt; 0.
     */
    public static String random(final int count, final boolean letters, final boolean numbers) {
<span class="fc" id="L129">        return secure().next(count, letters, numbers);</span>
    }

    /**
     * Creates a random string whose length is the number of characters specified.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of characters specified.
     * &lt;/p&gt;
     *
     * @param count the length of random string to create
     * @param chars the character array containing the set of characters to use, may be null
     * @return the random string
     * @throws IllegalArgumentException if {@code count} &amp;lt; 0.
     */
    public static String random(final int count, final char... chars) {
<span class="fc" id="L145">        return secure().next(count, chars);</span>
    }

    /**
     * Creates a random string whose length is the number of characters specified.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of alpha-numeric characters as indicated by the arguments.
     * &lt;/p&gt;
     *
     * @param count   the length of random string to create
     * @param start   the position in set of chars to start at
     * @param end     the position in set of chars to end before
     * @param letters if {@code true}, generated string may include alphabetic characters
     * @param numbers if {@code true}, generated string may include numeric characters
     * @return the random string
     * @throws IllegalArgumentException if {@code count} &amp;lt; 0.
     */
    public static String random(final int count, final int start, final int end, final boolean letters,
            final boolean numbers) {
<span class="fc" id="L165">        return secure().next(count, start, end, letters, numbers);</span>
    }

    /**
     * Creates a random string based on a variety of options, using default source of randomness.
     *
     * &lt;p&gt;
     * This method has exactly the same semantics as {@link #random(int,int,int,boolean,boolean,char[],Random)}, but
     * instead of using an externally supplied source of randomness, it uses the internal static {@link Random}
     * instance.
     * &lt;/p&gt;
     *
     * @param count   the length of random string to create
     * @param start   the position in set of chars to start at
     * @param end     the position in set of chars to end before
     * @param letters if {@code true}, generated string may include alphabetic characters
     * @param numbers if {@code true}, generated string may include numeric characters
     * @param chars   the set of chars to choose randoms from. If {@code null}, then it will use the set of all chars.
     * @return the random string
     * @throws ArrayIndexOutOfBoundsException if there are not {@code (end - start) + 1} characters in the set array.
     * @throws IllegalArgumentException       if {@code count} &amp;lt; 0.
     */
    public static String random(final int count, final int start, final int end, final boolean letters,
            final boolean numbers, final char... chars) {
<span class="nc" id="L189">        return secure().next(count, start, end, letters, numbers, chars);</span>
    }

    /**
     * Creates a random string based on a variety of options, using supplied source of randomness.
     *
     * &lt;p&gt;
     * If start and end are both {@code 0}, start and end are set to {@code ' '} and {@code 'z'}, the ASCII printable
     * characters, will be used, unless letters and numbers are both {@code false}, in which case, start and end are set
     * to {@code 0} and {@link Character#MAX_CODE_POINT}.
     *
     * &lt;p&gt;
     * If set is not {@code null}, characters between start and end are chosen.
     * &lt;/p&gt;
     *
     * &lt;p&gt;
     * This method accepts a user-supplied {@link Random} instance to use as a source of randomness. By seeding a single
     * {@link Random} instance with a fixed seed and using it for each call, the same random sequence of strings can be
     * generated repeatedly and predictably.
     * &lt;/p&gt;
     *
     * @param count   the length of random string to create
     * @param start   the position in set of chars to start at (inclusive)
     * @param end     the position in set of chars to end before (exclusive)
     * @param letters if {@code true}, generated string may include alphabetic characters
     * @param numbers if {@code true}, generated string may include numeric characters
     * @param chars   the set of chars to choose randoms from, must not be empty. If {@code null}, then it will use the
     *                set of all chars.
     * @param random  a source of randomness.
     * @return the random string
     * @throws ArrayIndexOutOfBoundsException if there are not {@code (end - start) + 1} characters in the set array.
     * @throws IllegalArgumentException       if {@code count} &amp;lt; 0 or the provided chars array is empty.
     * @since 2.0
     */
    public static String random(int count, int start, int end, final boolean letters, final boolean numbers,
            final char[] chars, final Random random) {
<span class="fc bfc" id="L225" title="All 2 branches covered.">        if (count == 0) {</span>
<span class="fc" id="L226">            return StringUtils.EMPTY;</span>
        }
<span class="fc bfc" id="L228" title="All 2 branches covered.">        if (count &lt; 0) {</span>
<span class="fc" id="L229">            throw new IllegalArgumentException(&quot;Requested random string length &quot; + count + &quot; is less than 0.&quot;);</span>
        }
<span class="fc bfc" id="L231" title="All 4 branches covered.">        if (chars != null &amp;&amp; chars.length == 0) {</span>
<span class="fc" id="L232">            throw new IllegalArgumentException(&quot;The chars array must not be empty&quot;);</span>
        }

<span class="fc bfc" id="L235" title="All 4 branches covered.">        if (start == 0 &amp;&amp; end == 0) {</span>
<span class="fc bfc" id="L236" title="All 2 branches covered.">            if (chars != null) {</span>
<span class="fc" id="L237">                end = chars.length;</span>
<span class="fc bfc" id="L238" title="All 4 branches covered.">            } else if (!letters &amp;&amp; !numbers) {</span>
<span class="fc" id="L239">                end = Character.MAX_CODE_POINT;</span>
            } else {
<span class="fc" id="L241">                end = 'z' + 1;</span>
<span class="fc" id="L242">                start = ' ';</span>
            }
<span class="fc bfc" id="L244" title="All 2 branches covered.">        } else if (end &lt;= start) {</span>
<span class="fc" id="L245">            throw new IllegalArgumentException(</span>
                    &quot;Parameter end (&quot; + end + &quot;) must be greater than start (&quot; + start + &quot;)&quot;);
<span class="pc bpc" id="L247" title="1 of 4 branches missed.">        } else if (start &lt; 0 || end &lt; 0) {</span>
<span class="fc" id="L248">            throw new IllegalArgumentException(&quot;Character positions MUST be &gt;= 0&quot;);</span>
        }

<span class="fc bfc" id="L251" title="All 2 branches covered.">        if (end &gt; Character.MAX_CODE_POINT) {</span>
            // Technically, it should be `Character.MAX_CODE_POINT+1` as `end` is excluded
            // But the character `Character.MAX_CODE_POINT` is private use, so it would anyway be excluded
<span class="fc" id="L254">            end = Character.MAX_CODE_POINT;</span>
        }

        // Optimize generation of full alphanumerical characters
        // Normally, we would need to pick a 7-bit integer, since gap = 'z' - '0' + 1 = 75 &gt; 64
        // In turn, this would make us reject the sampling with probability 1 - 62 / 2^7 &gt; 1 / 2
        // Instead we can pick directly from the right set of 62 characters, which requires
        // picking a 6-bit integer and only rejecting with probability 2 / 64 = 1 / 32
<span class="pc bpc" id="L262" title="2 of 10 branches missed.">        if (chars == null &amp;&amp; letters &amp;&amp; numbers &amp;&amp; start &lt;= '0' &amp;&amp; end &gt;= 'z' + 1) {</span>
<span class="fc" id="L263">            return random(count, 0, 0, false, false, ALPHANUMERICAL_CHARS, random);</span>
        }

        // Optimize start and end when filtering by letters and/or numbers:
        // The range provided may be too large since we filter anyway afterward.
        // Note the use of Math.min/max (as opposed to setting start to '0' for example),
        // since it is possible the range start/end excludes some of the letters/numbers,
        // e.g., it is possible that start already is '1' when numbers = true, and start
        // needs to stay equal to '1' in that case.
<span class="fc bfc" id="L272" title="All 2 branches covered.">        if (chars == null) {</span>
<span class="pc bpc" id="L273" title="1 of 4 branches missed.">            if (letters &amp;&amp; numbers) {</span>
<span class="nc" id="L274">                start = Math.max('0', start);</span>
<span class="nc" id="L275">                end = Math.min('z' + 1, end);</span>
<span class="fc bfc" id="L276" title="All 2 branches covered.">            } else if (numbers) {</span>
                // just numbers, no letters
<span class="fc" id="L278">                start = Math.max('0', start);</span>
<span class="fc" id="L279">                end = Math.min('9' + 1, end);</span>
<span class="fc bfc" id="L280" title="All 2 branches covered.">            } else if (letters) {</span>
                // just letters, no numbers
<span class="fc" id="L282">                start = Math.max('A', start);</span>
<span class="fc" id="L283">                end = Math.min('z' + 1, end);</span>
            }
        }

<span class="fc" id="L287">        final int zeroDigitAscii = 48;</span>
<span class="fc" id="L288">        final int firstLetterAscii = 65;</span>

<span class="fc bfc" id="L290" title="All 10 branches covered.">        if (chars == null &amp;&amp; (numbers &amp;&amp; end &lt;= zeroDigitAscii || letters &amp;&amp; end &lt;= firstLetterAscii)) {</span>
<span class="fc" id="L291">            throw new IllegalArgumentException(</span>
                    &quot;Parameter end (&quot; + end + &quot;) must be greater then (&quot; + zeroDigitAscii + &quot;) for generating digits &quot;
                            + &quot;or greater then (&quot; + firstLetterAscii + &quot;) for generating letters.&quot;);
        }

<span class="fc" id="L296">        final StringBuilder builder = new StringBuilder(count);</span>
<span class="fc" id="L297">        final int gap = end - start;</span>
<span class="fc" id="L298">        final int gapBits = Integer.SIZE - Integer.numberOfLeadingZeros(gap);</span>
        // The size of the cache we use is an heuristic:
        // about twice the number of bytes required if no rejection
        // Ideally the cache size depends on multiple factor, including the cost of generating x bytes
        // of randomness as well as the probability of rejection. It is however not easy to know
        // those values programmatically for the general case.
<span class="fc" id="L304">        final CachedRandomBits arb = new CachedRandomBits((count * gapBits + 3) / 5 + 10, random);</span>

<span class="fc bfc" id="L306" title="All 2 branches covered.">        while (count-- != 0) {</span>
            // Generate a random value between start (included) and end (excluded)
<span class="fc" id="L308">            final int randomValue = arb.nextBits(gapBits) + start;</span>
            // Rejection sampling if value too large
<span class="fc bfc" id="L310" title="All 2 branches covered.">            if (randomValue &gt;= end) {</span>
<span class="fc" id="L311">                count++;</span>
<span class="fc" id="L312">                continue;</span>
            }

            final int codePoint;
<span class="fc bfc" id="L316" title="All 2 branches covered.">            if (chars == null) {</span>
<span class="fc" id="L317">                codePoint = randomValue;</span>

<span class="fc bfc" id="L319" title="All 2 branches covered.">                switch (Character.getType(codePoint)) {</span>
                case Character.UNASSIGNED:
                case Character.PRIVATE_USE:
                case Character.SURROGATE:
<span class="fc" id="L323">                    count++;</span>
<span class="fc" id="L324">                    continue;</span>
                }

            } else {
<span class="fc" id="L328">                codePoint = chars[randomValue];</span>
            }

<span class="fc" id="L331">            final int numberOfChars = Character.charCount(codePoint);</span>
<span class="fc bfc" id="L332" title="All 4 branches covered.">            if (count == 0 &amp;&amp; numberOfChars &gt; 1) {</span>
<span class="fc" id="L333">                count++;</span>
<span class="fc" id="L334">                continue;</span>
            }

<span class="pc bpc" id="L337" title="2 of 12 branches missed.">            if (letters &amp;&amp; Character.isLetter(codePoint) || numbers &amp;&amp; Character.isDigit(codePoint)</span>
                    || !letters &amp;&amp; !numbers) {
<span class="fc" id="L339">                builder.appendCodePoint(codePoint);</span>

<span class="fc bfc" id="L341" title="All 2 branches covered.">                if (numberOfChars == 2) {</span>
<span class="fc" id="L342">                    count--;</span>
                }

            } else {
<span class="fc" id="L346">                count++;</span>
            }
<span class="fc" id="L348">        }</span>
<span class="fc" id="L349">        return builder.toString();</span>
    }

    /**
     * Creates a random string whose length is the number of characters specified.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of characters specified by the string, must not be empty. If null, the set
     * of all characters is used.
     * &lt;/p&gt;
     *
     * @param count the length of random string to create
     * @param chars the String containing the set of characters to use, may be null, but must not be empty
     * @return the random string
     * @throws IllegalArgumentException if {@code count} &amp;lt; 0 or the string is empty.
     */
    public static String random(final int count, final String chars) {
<span class="nc" id="L366">        return secure().next(count, chars);</span>
    }

    /**
     * Creates a random string whose length is the number of characters specified.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of Latin alphabetic characters (a-z, A-Z).
     * &lt;/p&gt;
     *
     * @param count the length of random string to create
     * @return the random string
     * @throws IllegalArgumentException if {@code count} &amp;lt; 0.
     */
    public static String randomAlphabetic(final int count) {
<span class="fc" id="L381">        return secure().nextAlphabetic(count);</span>
    }

    /**
     * Creates a random string whose length is between the inclusive minimum and the exclusive maximum.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of Latin alphabetic characters (a-z, A-Z).
     * &lt;/p&gt;
     *
     * @param minLengthInclusive the inclusive minimum length of the string to generate
     * @param maxLengthExclusive the exclusive maximum length of the string to generate
     * @return the random string
     * @since 3.5
     */
    public static String randomAlphabetic(final int minLengthInclusive, final int maxLengthExclusive) {
<span class="fc" id="L397">        return secure().nextAlphabetic(minLengthInclusive, maxLengthExclusive);</span>
    }

    /**
     * Creates a random string whose length is the number of characters specified.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of Latin alphabetic characters (a-z, A-Z) and the digits 0-9.
     * &lt;/p&gt;
     *
     * @param count the length of random string to create
     * @return the random string
     * @throws IllegalArgumentException if {@code count} &amp;lt; 0.
     */
    public static String randomAlphanumeric(final int count) {
<span class="fc" id="L412">        return secure().nextAlphanumeric(count);</span>
    }

    /**
     * Creates a random string whose length is between the inclusive minimum and the exclusive maximum.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of Latin alphabetic characters (a-z, A-Z) and the digits 0-9.
     * &lt;/p&gt;
     *
     * @param minLengthInclusive the inclusive minimum length of the string to generate
     * @param maxLengthExclusive the exclusive maximum length of the string to generate
     * @return the random string
     * @since 3.5
     */
    public static String randomAlphanumeric(final int minLengthInclusive, final int maxLengthExclusive) {
<span class="fc" id="L428">        return secure().nextAlphanumeric(minLengthInclusive, maxLengthExclusive);</span>
    }

    /**
     * Creates a random string whose length is the number of characters specified.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of characters whose ASCII value is between {@code 32} and {@code 126}
     * (inclusive).
     * &lt;/p&gt;
     *
     * @param count the length of random string to create
     * @return the random string
     * @throws IllegalArgumentException if {@code count} &amp;lt; 0.
     */
    public static String randomAscii(final int count) {
<span class="fc" id="L444">        return secure().nextAscii(count);</span>
    }

    /**
     * Creates a random string whose length is between the inclusive minimum and the exclusive maximum.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of characters whose ASCII value is between {@code 32} and {@code 126}
     * (inclusive).
     * &lt;/p&gt;
     *
     * @param minLengthInclusive the inclusive minimum length of the string to generate
     * @param maxLengthExclusive the exclusive maximum length of the string to generate
     * @return the random string
     * @since 3.5
     */
    public static String randomAscii(final int minLengthInclusive, final int maxLengthExclusive) {
<span class="nc" id="L461">        return secure().nextAscii(minLengthInclusive, maxLengthExclusive);</span>
    }

    /**
     * Creates a random string whose length is the number of characters specified.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of characters which match the POSIX [:graph:] regular expression character
     * class. This class contains all visible ASCII characters (i.e. anything except spaces and control characters).
     * &lt;/p&gt;
     *
     * @param count the length of random string to create
     * @return the random string
     * @throws IllegalArgumentException if {@code count} &amp;lt; 0.
     * @since 3.5
     */
    public static String randomGraph(final int count) {
<span class="fc" id="L478">        return secure().nextGraph(count);</span>
    }

    /**
     * Creates a random string whose length is between the inclusive minimum and the exclusive maximum.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of \p{Graph} characters.
     * &lt;/p&gt;
     *
     * @param minLengthInclusive the inclusive minimum length of the string to generate
     * @param maxLengthExclusive the exclusive maximum length of the string to generate
     * @return the random string
     * @since 3.5
     */
    public static String randomGraph(final int minLengthInclusive, final int maxLengthExclusive) {
<span class="nc" id="L494">        return secure().nextGraph(minLengthInclusive, maxLengthExclusive);</span>
    }

    /**
     * Creates a random string whose length is the number of characters specified.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of numeric characters.
     * &lt;/p&gt;
     *
     * @param count the length of random string to create
     * @return the random string
     * @throws IllegalArgumentException if {@code count} &amp;lt; 0.
     */
    public static String randomNumeric(final int count) {
<span class="fc" id="L509">        return secure().nextNumeric(count);</span>
    }

    /**
     * Creates a random string whose length is between the inclusive minimum and the exclusive maximum.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of \p{Digit} characters.
     * &lt;/p&gt;
     *
     * @param minLengthInclusive the inclusive minimum length of the string to generate
     * @param maxLengthExclusive the exclusive maximum length of the string to generate
     * @return the random string
     * @since 3.5
     */
    public static String randomNumeric(final int minLengthInclusive, final int maxLengthExclusive) {
<span class="nc" id="L525">        return secure().nextNumeric(minLengthInclusive, maxLengthExclusive);</span>
    }

    /**
     * Creates a random string whose length is the number of characters specified.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of characters which match the POSIX [:print:] regular expression character
     * class. This class includes all visible ASCII characters and spaces (i.e. anything except control characters).
     * &lt;/p&gt;
     *
     * @param count the length of random string to create
     * @return the random string
     * @throws IllegalArgumentException if {@code count} &amp;lt; 0.
     * @since 3.5
     */
    public static String randomPrint(final int count) {
<span class="fc" id="L542">        return secure().nextPrint(count);</span>
    }

    /**
     * Creates a random string whose length is between the inclusive minimum and the exclusive maximum.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of \p{Print} characters.
     * &lt;/p&gt;
     *
     * @param minLengthInclusive the inclusive minimum length of the string to generate
     * @param maxLengthExclusive the exclusive maximum length of the string to generate
     * @return the random string
     * @since 3.5
     */
    public static String randomPrint(final int minLengthInclusive, final int maxLengthExclusive) {
<span class="nc" id="L558">        return secure().nextPrint(minLengthInclusive, maxLengthExclusive);</span>
    }

    /**
     * Gets the singleton instance based on {@link SecureRandom#getInstanceStrong()} which uses an algorithms/providers
     * specified in the {@code securerandom.strongAlgorithms} {@link Security} property.
     * &lt;p&gt;
     * The method {@link SecureRandom#getInstanceStrong()} is called on-demand.
     * &lt;/p&gt;
     *
     * @return the singleton instance based on {@link SecureRandom#getInstanceStrong()}.
     * @see SecureRandom#getInstanceStrong()
     * @since 3.16.0
     */
    public static RandomStringUtils secure() {
<span class="fc" id="L573">        return SECURE;</span>
    }

    private final Supplier&lt;RandomUtils&gt; random;

    /**
     * {@link RandomStringUtils} instances should NOT be constructed in standard programming. Instead, the class should
     * be used as {@code RandomStringUtils.random(5);}.
     *
     * &lt;p&gt;
     * This constructor is public to permit tools that require a JavaBean instance to operate.
     * &lt;/p&gt;
     *
     * @deprecated TODO Make private in 4.0.
     */
    @Deprecated
    public RandomStringUtils() {
<span class="fc" id="L590">        this(SECURE_SUPPLIER);</span>
<span class="fc" id="L591">    }</span>

<span class="fc" id="L593">    private RandomStringUtils(final Supplier&lt;RandomUtils&gt; random) {</span>
<span class="fc" id="L594">        this.random = random;</span>
<span class="fc" id="L595">    }</span>

    /**
     * Creates a random string whose length is the number of characters specified.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of all characters.
     * &lt;/p&gt;
     *
     * @param count the length of random string to create
     * @return the random string
     * @throws IllegalArgumentException if {@code count} &amp;lt; 0.
     * @since 3.16.0
     */
    public String next(final int count) {
<span class="fc" id="L610">        return random(count, false, false);</span>
    }

    /**
     * Creates a random string whose length is the number of characters specified.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of alpha-numeric characters as indicated by the arguments.
     * &lt;/p&gt;
     *
     * @param count   the length of random string to create
     * @param letters if {@code true}, generated string may include alphabetic characters
     * @param numbers if {@code true}, generated string may include numeric characters
     * @return the random string
     * @throws IllegalArgumentException if {@code count} &amp;lt; 0.
     * @since 3.16.0
     */
    public String next(final int count, final boolean letters, final boolean numbers) {
<span class="fc" id="L628">        return random(count, 0, 0, letters, numbers);</span>
    }

    /**
     * Creates a random string whose length is the number of characters specified.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of characters specified.
     * &lt;/p&gt;
     *
     * @param count the length of random string to create
     * @param chars the character array containing the set of characters to use, may be null
     * @return the random string
     * @throws IllegalArgumentException if {@code count} &amp;lt; 0.
     * @since 3.16.0
     */
    public String next(final int count, final char... chars) {
<span class="fc bfc" id="L645" title="All 2 branches covered.">        if (chars == null) {</span>
<span class="fc" id="L646">            return random(count, 0, 0, false, false, null, random());</span>
        }
<span class="fc" id="L648">        return random(count, 0, chars.length, false, false, chars, random());</span>
    }

    /**
     * Creates a random string whose length is the number of characters specified.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of alpha-numeric characters as indicated by the arguments.
     * &lt;/p&gt;
     *
     * @param count   the length of random string to create
     * @param start   the position in set of chars to start at
     * @param end     the position in set of chars to end before
     * @param letters if {@code true}, generated string may include alphabetic characters
     * @param numbers if {@code true}, generated string may include numeric characters
     * @return the random string
     * @throws IllegalArgumentException if {@code count} &amp;lt; 0.
     * @since 3.16.0
     */
    public String next(final int count, final int start, final int end, final boolean letters, final boolean numbers) {
<span class="fc" id="L668">        return random(count, start, end, letters, numbers, null, random());</span>
    }

    /**
     * Creates a random string based on a variety of options, using default source of randomness.
     *
     * &lt;p&gt;
     * This method has exactly the same semantics as {@link #random(int,int,int,boolean,boolean,char[],Random)}, but
     * instead of using an externally supplied source of randomness, it uses the internal static {@link Random}
     * instance.
     * &lt;/p&gt;
     *
     * @param count   the length of random string to create
     * @param start   the position in set of chars to start at
     * @param end     the position in set of chars to end before
     * @param letters if {@code true}, generated string may include alphabetic characters
     * @param numbers if {@code true}, generated string may include numeric characters
     * @param chars   the set of chars to choose randoms from. If {@code null}, then it will use the set of all chars.
     * @return the random string
     * @throws ArrayIndexOutOfBoundsException if there are not {@code (end - start) + 1} characters in the set array.
     * @throws IllegalArgumentException       if {@code count} &amp;lt; 0.
     */
    public String next(final int count, final int start, final int end, final boolean letters, final boolean numbers,
            final char... chars) {
<span class="fc" id="L692">        return random(count, start, end, letters, numbers, chars, random());</span>
    }

    /**
     * Creates a random string whose length is the number of characters specified.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of characters specified by the string, must not be empty. If null, the set
     * of all characters is used.
     * &lt;/p&gt;
     *
     * @param count the length of random string to create
     * @param chars the String containing the set of characters to use, may be null, but must not be empty
     * @return the random string
     * @throws IllegalArgumentException if {@code count} &amp;lt; 0 or the string is empty.
     * @since 3.16.0
     */
    public String next(final int count, final String chars) {
<span class="fc bfc" id="L710" title="All 2 branches covered.">        if (chars == null) {</span>
<span class="fc" id="L711">            return random(count, 0, 0, false, false, null, random());</span>
        }
<span class="fc" id="L713">        return random(count, chars.toCharArray());</span>
    }

    /**
     * Creates a random string whose length is the number of characters specified.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of Latin alphabetic characters (a-z, A-Z).
     * &lt;/p&gt;
     *
     * @param count the length of random string to create
     * @return the random string
     * @throws IllegalArgumentException if {@code count} &amp;lt; 0.
     */
    public String nextAlphabetic(final int count) {
<span class="fc" id="L728">        return random(count, true, false);</span>
    }

    /**
     * Creates a random string whose length is between the inclusive minimum and the exclusive maximum.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of Latin alphabetic characters (a-z, A-Z).
     * &lt;/p&gt;
     *
     * @param minLengthInclusive the inclusive minimum length of the string to generate
     * @param maxLengthExclusive the exclusive maximum length of the string to generate
     * @return the random string
     * @since 3.5
     */
    public String nextAlphabetic(final int minLengthInclusive, final int maxLengthExclusive) {
<span class="fc" id="L744">        return randomAlphabetic(randomUtils().randomInt(minLengthInclusive, maxLengthExclusive));</span>
    }

    /**
     * Creates a random string whose length is the number of characters specified.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of Latin alphabetic characters (a-z, A-Z) and the digits 0-9.
     * &lt;/p&gt;
     *
     * @param count the length of random string to create
     * @return the random string
     * @throws IllegalArgumentException if {@code count} &amp;lt; 0.
     */
    public String nextAlphanumeric(final int count) {
<span class="fc" id="L759">        return random(count, true, true);</span>
    }

    /**
     * Creates a random string whose length is between the inclusive minimum and the exclusive maximum.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of Latin alphabetic characters (a-z, A-Z) and the digits 0-9.
     * &lt;/p&gt;
     *
     * @param minLengthInclusive the inclusive minimum length of the string to generate
     * @param maxLengthExclusive the exclusive maximum length of the string to generate
     * @return the random string
     * @since 3.5
     */
    public String nextAlphanumeric(final int minLengthInclusive, final int maxLengthExclusive) {
<span class="fc" id="L775">        return randomAlphanumeric(randomUtils().randomInt(minLengthInclusive, maxLengthExclusive));</span>
    }

    /**
     * Creates a random string whose length is the number of characters specified.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of characters whose ASCII value is between {@code 32} and {@code 126}
     * (inclusive).
     * &lt;/p&gt;
     *
     * @param count the length of random string to create
     * @return the random string
     * @throws IllegalArgumentException if {@code count} &amp;lt; 0.
     */
    public String nextAscii(final int count) {
<span class="fc" id="L791">        return random(count, 32, 127, false, false);</span>
    }

    /**
     * Creates a random string whose length is between the inclusive minimum and the exclusive maximum.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of characters whose ASCII value is between {@code 32} and {@code 126}
     * (inclusive).
     * &lt;/p&gt;
     *
     * @param minLengthInclusive the inclusive minimum length of the string to generate
     * @param maxLengthExclusive the exclusive maximum length of the string to generate
     * @return the random string
     * @since 3.5
     */
    public String nextAscii(final int minLengthInclusive, final int maxLengthExclusive) {
<span class="fc" id="L808">        return randomAscii(randomUtils().randomInt(minLengthInclusive, maxLengthExclusive));</span>
    }

    /**
     * Creates a random string whose length is the number of characters specified.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of characters which match the POSIX [:graph:] regular expression character
     * class. This class contains all visible ASCII characters (i.e. anything except spaces and control characters).
     * &lt;/p&gt;
     *
     * @param count the length of random string to create
     * @return the random string
     * @throws IllegalArgumentException if {@code count} &amp;lt; 0.
     * @since 3.5
     */
    public String nextGraph(final int count) {
<span class="fc" id="L825">        return random(count, 33, 126, false, false);</span>
    }

    /**
     * Creates a random string whose length is between the inclusive minimum and the exclusive maximum.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of \p{Graph} characters.
     * &lt;/p&gt;
     *
     * @param minLengthInclusive the inclusive minimum length of the string to generate
     * @param maxLengthExclusive the exclusive maximum length of the string to generate
     * @return the random string
     * @since 3.5
     */
    public String nextGraph(final int minLengthInclusive, final int maxLengthExclusive) {
<span class="fc" id="L841">        return randomGraph(randomUtils().randomInt(minLengthInclusive, maxLengthExclusive));</span>
    }

    /**
     * Creates a random string whose length is the number of characters specified.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of numeric characters.
     * &lt;/p&gt;
     *
     * @param count the length of random string to create
     * @return the random string
     * @throws IllegalArgumentException if {@code count} &amp;lt; 0.
     */
    public String nextNumeric(final int count) {
<span class="fc" id="L856">        return random(count, false, true);</span>
    }

    /**
     * Creates a random string whose length is between the inclusive minimum and the exclusive maximum.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of \p{Digit} characters.
     * &lt;/p&gt;
     *
     * @param minLengthInclusive the inclusive minimum length of the string to generate
     * @param maxLengthExclusive the exclusive maximum length of the string to generate
     * @return the random string
     * @since 3.5
     */
    public String nextNumeric(final int minLengthInclusive, final int maxLengthExclusive) {
<span class="fc" id="L872">        return randomNumeric(randomUtils().randomInt(minLengthInclusive, maxLengthExclusive));</span>
    }

    /**
     * Creates a random string whose length is the number of characters specified.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of characters which match the POSIX [:print:] regular expression character
     * class. This class includes all visible ASCII characters and spaces (i.e. anything except control characters).
     * &lt;/p&gt;
     *
     * @param count the length of random string to create
     * @return the random string
     * @throws IllegalArgumentException if {@code count} &amp;lt; 0.
     * @since 3.5
     * @since 3.16.0
     */
    public String nextPrint(final int count) {
<span class="fc" id="L890">        return random(count, 32, 126, false, false);</span>
    }

    /**
     * Creates a random string whose length is between the inclusive minimum and the exclusive maximum.
     *
     * &lt;p&gt;
     * Characters will be chosen from the set of \p{Print} characters.
     * &lt;/p&gt;
     *
     * @param minLengthInclusive the inclusive minimum length of the string to generate
     * @param maxLengthExclusive the exclusive maximum length of the string to generate
     * @return the random string
     * @since 3.16.0
     */
    public String nextPrint(final int minLengthInclusive, final int maxLengthExclusive) {
<span class="fc" id="L906">        return randomPrint(randomUtils().randomInt(minLengthInclusive, maxLengthExclusive));</span>
    }

    /**
     * Gets the Random.
     *
     * @return the Random.
     */
    private Random random() {
<span class="fc" id="L915">        return randomUtils().random();</span>
    }

    /**
     * Gets the RandomUtils.
     *
     * @return the RandomUtils.
     */
    private RandomUtils randomUtils() {
<span class="fc" id="L924">        return random.get();</span>
    }

    @Override
    public String toString() {
<span class="fc" id="L929">        return &quot;RandomStringUtils [random=&quot; + random() + &quot;]&quot;;</span>
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>